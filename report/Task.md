# 条件支付系统（双哈希锁 + 超时退回）

## 背景介绍

在跨链交易、链下支付通道等场景中，经常会用到 Hash Time Locked Contract（HTLC） 模式：

* 付款人创建一个带哈希锁和时间锁的 Cell
* 收款人必须在时间锁到期前提交正确的 preimage 解锁
* 如果超时未解锁，付款人可以退回资金

本任务要求你在 Nervos CKB 上实现一个 双哈希锁 + 超时退回 的支付系统：
* 双哈希锁：需要同时提供两个不同的 preimage 才能解锁（例如来自两方的确认）
* 超时退回：到达指定区块高度后，付款人可退回资金

## 任务目标

链上部分（Lock Script）

* 学习 CKB 的 Cell 模型, 设计并实现如何在链上存储双哈希锁和超时退回的相关信息, 包括:
    - 支付人公钥（或哈希）
    - 收款人公钥（或哈希）
    - 哈希锁 1
    - 哈希锁 2
    - 过期区块高度（since 值）

* 实现解锁条件：
    - 在 since 到期前：
        - 必须提供两个正确的 preimage（对应哈希锁 1、哈希锁 2）
        - 且签名验证通过（收款人）
    - 在 since 到期后：
        - 付款人签名验证通过即可退回


链下部分（交易构造与测试）

* 创建一个符合上述规则的 Cell，并存入 CKB
    - 测试 1（成功收款）：收款人提供两个 preimage + 签名 → 成功
    - 测试 2（超时退回）：付款人在 since 到期后花费 → 成功
    - 测试 3（失败）：缺失 preimage 或签名 → 失败
* 要求生成交易的 witness 数据并正确编码

文档

* Cell / Witness 数据结构说明（字段、编码格式）
* 交易构造流程
* 测试截图与执行结果
